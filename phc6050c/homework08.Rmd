---
title: "Homework 8"
output: html_document
date: "2024-10-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##1. 

a. We do not see significance in the leg predictor on the response.

```{r}

data(seatpos, package = "faraway")

lmod <- lm(hipcenter ~ ., seatpos)

summary(lmod)

```

b.

```{r}

x <- model.matrix(lmod)

x0 <- apply(x, 2, mean)

predict(lmod, new = data.frame(t(x0)), interval = "prediction", level=0.99)

```

c.

Part 1. Backwards elimination

```{r}

lmod <- lm(hipcenter ~ ., seatpos)

lmod2 <- update(lmod, . ~ . -Ht)

lmod3 <- update(lmod2, . ~ . -Weight)

lmod4 <- update(lmod3, . ~ . -Seated)

lmod5 <- update(lmod4, . ~ . -Arm)

lmod6 <- update(lmod5, . ~ . -Thigh)

lmod7 <- update(lmod6, . ~ . -Age)

lmod8 <- update(lmod7, . ~ . -Leg)


# Used in the process of finding the best model:
# summary(lmod)
# summary(lmod2)
# summary(lmod3)
# summary(lmod4)
# summary(lmod5)
# summary(lmod6)
# summary(lmod7)

summary(lmod8)

```

Part 2. AIC: We find the optimal model seemingly to be Age + Ht + Leg

```{r}

require(leaps)

b <- regsubsets(hipcenter ~ ., seatpos)

rs <- summary(b)

rs$which

AIC <- 38 * log(rs$rss/38) + (2:9) * 2

plot(AIC ~ I(1:8), ylab = "AIC", xlab = "Number of Predictors")

```

Part 3. Adjusted R^2: again, we find the best model to be Age + Ht + Leg

```{r}

plot(2:9, rs$adjr2, xlab = "Number of parameters", ylab = "Adjusted R-Squared")
which.max(rs$adjr2)

```

Part 4. Stepwise selection: we find Age + HtShoes + Leg appears to be the best model.

```{r}

lmod <- lm(hipcenter ~ ., data=seatpos)
step(lmod)

```

d. Using the model chosen by AIC, it appears that for every increase of a unit of leg length, we can expect to see hipcenter decrease by -6.739. The model has a very similar multiple r-squared value to the original, though it has a much higher adjusted r-squared, 0.6533 to the original model's 0.6001. 

```{r}

lmodAIC <- lm(hipcenter ~ Age + Ht + Leg, seatpos)
summary(lmodAIC)

z <- model.matrix(lmodAIC)

z0 <- apply(z, 2, mean)

predict(lmodAIC, new = data.frame(t(z0)), interval = "prediction", level=0.99)

```